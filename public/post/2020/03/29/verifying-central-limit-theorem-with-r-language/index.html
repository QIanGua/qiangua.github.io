<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>Verifying Central Limit Theorem with R Language - 采采流水</title>
    <meta property="og:title" content="Verifying Central Limit Theorem with R Language - 采采流水">
    
    <meta name="twitter:card" content="summary">

    
      
    

    
      
      <meta property="description" content="一个随机量可能是 $1$,也可能是 $‐1$。两个值的几率都是 $1/2$。现进行 $1000$ 次实验,每次实验进行 $100$ 次随机量测试。模拟这个实验, 验证中心极限定理。
Sloution:
Definition:
number of observations: $N_{observations} = 1000$,
number of trials: $N_{trials} = &amp;hellip;">
      <meta property="og:description" content="一个随机量可能是 $1$,也可能是 $‐1$。两个值的几率都是 $1/2$。现进行 $1000$ 次实验,每次实验进行 $100$ 次随机量测试。模拟这个实验, 验证中心极限定理。
Sloution:
Definition:
number of observations: $N_{observations} = 1000$,
number of trials: $N_{trials} = &amp;hellip;">
      
    

    
    

    

    
    


<link href='//cdn.bootcss.com/highlight.js/9.12.0/styles/github.min.css' rel='stylesheet' type='text/css' />



    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
  </head>

  
  <body class="post">
    <header class="masthead">
      <h1><a href="/">采采流水</a></h1>

<p class="tagline"> An Essay Concerning Human Understanding</p>

      <nav class="menu">
  <input id="menu-check" type="checkbox" />
  <label id="menu-label" for="menu-check" class="unselectable">
    <span class="icon close-icon">✕</span>
    <span class="icon open-icon">☰</span>
    <span class="text">Menu</span>
  </label>
  <ul>
  
  
  <li><a href="/">Home</a></li>
  
  <li><a href="/about/">About</a></li>
  
  <li><a href="/books/">Books</a></li>
  
  <li><a href="/moments/">Moments</a></li>
  
  <li><a href="/index.xml">Subscribe</a></li>
  
  
  </ul>
</nav>

    </header>

    <article class="main">
      <header class="title">
      
<h1>Verifying Central Limit Theorem with R Language</h1>

<h3>Qiangua
  /  2020-03-29</h3>
<hr>


      </header>



<h2 id="question">Question</h2>
<p><strong>一个随机量可能是 $1$,也可能是 $‐1$。两个值的几率都是 $1/2$。现进行 $1000$ 次实验,每次实验进行 $100$ 次随机量测试。模拟这个实验, 验证中心极限定理。</strong></p>
<p><strong>Sloution:</strong></p>
<p>Definition:</p>
<p>number of observations: $N_{observations} = 1000$,</p>
<p>number of trials: $N_{trials} = 100$,</p>
<p>probability of success on each trial: $X_i(i=1,N_{observations})$,</p>
<p>mean vale of $X_i$: $\overline{X}$</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">library</span>(ggplot2)
<span style="color:#a6e22e">library</span>(magrittr)
<span style="color:#a6e22e">set.seed</span>(<span style="color:#ae81ff">2020</span>)
number_observation <span style="color:#f92672">&lt;-</span> <span style="color:#ae81ff">1000</span>
number_trial <span style="color:#f92672">&lt;-</span> <span style="color:#ae81ff">100</span>
p_val <span style="color:#f92672">&lt;-</span> <span style="color:#ae81ff">0.5</span>

trial_mean <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">rep</span>(<span style="color:#ae81ff">0</span>, number_observation)
trial_std <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">rep</span>(<span style="color:#ae81ff">0</span>, number_observation)

<span style="color:#a6e22e">for </span>(idx in <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span>number_observation) {
  trial <span style="color:#f92672">=</span> <span style="color:#a6e22e">rbinom</span>(number_trial, <span style="color:#ae81ff">1</span>, p_val)
  trial_mean[idx] <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">mean</span>(trial)
  trial_std[idx] <span style="color:#f92672">&lt;-</span> (<span style="color:#a6e22e">sum</span>(trial) <span style="color:#f92672">-</span> number_trial<span style="color:#f92672">*</span>p_val) <span style="color:#f92672">/</span> <span style="color:#a6e22e">sqrt</span>(number_trial<span style="color:#f92672">*</span>p_val<span style="color:#f92672">*</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>p_val)) 
}

df <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">data.frame</span>(heads <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span>number_observation,
                 trial_mean <span style="color:#f92672">=</span> trial_mean,
                 trial_std <span style="color:#f92672">=</span> trial_std)

mean_X1 <span style="color:#f92672">&lt;-</span> df<span style="color:#f92672">$</span>trial_mean <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">mean</span>()
sd_X1 <span style="color:#f92672">&lt;-</span> df<span style="color:#f92672">$</span>trial_mean <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">sd</span>()

mean_X2 <span style="color:#f92672">&lt;-</span> df<span style="color:#f92672">$</span>trial_std <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">mean</span>()
sd_X2 <span style="color:#f92672">&lt;-</span> df<span style="color:#f92672">$</span>trial_std <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">sd</span>()

<span style="color:#a6e22e">ggplot</span>(df,<span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> trial_std)) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_histogram</span>(bins <span style="color:#f92672">=</span> <span style="color:#ae81ff">30</span>, <span style="color:#a6e22e">aes</span>(y<span style="color:#f92672">=</span>..density..),color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;black&#34;</span>, size <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>, fill <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;gray&#34;</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">stat_function</span>(fun <span style="color:#f92672">=</span> dnorm, args <span style="color:#f92672">=</span> <span style="color:#a6e22e">list</span>(mean <span style="color:#f92672">=</span> mean_X2 , sd <span style="color:#f92672">=</span> sd_X2), colour <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;red&#34;</span>, size<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span> 
  <span style="color:#a6e22e">scale_x_continuous</span>(breaks<span style="color:#f92672">=</span><span style="color:#a6e22e">seq</span>(<span style="color:#ae81ff">-3</span>,<span style="color:#ae81ff">+3</span>,<span style="color:#ae81ff">1</span>), limits<span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">-3</span>,<span style="color:#ae81ff">+3</span>)) <span style="color:#f92672">+</span> 
  <span style="color:#a6e22e">scale_y_continuous</span>(breaks<span style="color:#f92672">=</span><span style="color:#a6e22e">seq</span>(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0.5</span>,<span style="color:#ae81ff">0.1</span>),limits <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0.5</span>)) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">xlab</span>(<span style="color:#e6db74">&#34;means&#34;</span>) <span style="color:#f92672">+</span> 
  <span style="color:#a6e22e">ylab</span>(<span style="color:#e6db74">&#34;density&#34;</span>)
</code></pre></div><figure>
    <img src="/ox-hugo/unnamed-chunk-1-1.png"/> 
</figure>



  <footer>
  
  <script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
  
  



<script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>



<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/r.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/yaml.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/tex.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/python.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/lisp.min.js"></script>
<script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>



  
  <hr>
  <div class="copyright">© <a href="https://qiangua.me">Qiangua</a> 2019 | <a href="https://www.instagram.com/mlyqdd/">Instagram</a></div>
  
  </footer>
  </article>
  
  </body>
</html>

